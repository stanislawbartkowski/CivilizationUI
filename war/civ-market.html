<dom-module id="civ-market">

<template>

<style>

:host {
    text-transform: none;
  }
  
  .unitname {
    border-radius: 15px;
    width: 90%;
    height: 30px; 
    text-align: center;
    font-size: 150%;
    padding-top: 5px;
    background-color : YellowGreen ;
    margin-left: 5px;
  }
  
  .unitbox {
     margin-left: 5px;
     margin-top: 2px;
     border:1px ridge gray ; 
     border-radius: 5px;
     vertical-align: top;
     display: flex;
     flex-direction: column;
     flex-wrap: wrap;  
   }
   
   .unitelem {
     margin : 4px;
   }
   
   .units {
      display: flex; 
      float: left;
   }
   
   .resourcesbox {
     margin-left: 5px;
     margin-top: 2px;
     border:1px ridge gray ; 
     border-radius: 5px;
     vertical-align: top;
     display: flex;
     flex-direction: column;
     flex-wrap: wrap;
     width : 110px;
   }
   
   .buildings {
     margin-top : 5px;
     width : 270px;
   }
   
   .wondersbox {
     vertical-align: top;
     margin-left: 5px;
     margin-top: 2px;
     display: flex;
     flex-direction: column;
     flex-wrap: wrap;
     width : 470px;
   }
   
  </style>
  
  <div>
  <div class="units">
    <div id="units" class=unitbox>
      <div class="unitname">{{localize('units')}}</div>
      <civ-units class="unitelem" id="infantry"></civ-units>
      <civ-units class="unitelem" id="artillery"></civ-units>
      <civ-units class="unitelem" id="mounted"></civ-units>
      <civ-units class="unitelem" id="aircraft"></civ-units>
    </div>  
  
    <div id="killed" class="unitbox">
      <div class="unitname">{{localize('killedunits')}}</div>
      <civ-units class="unitelem" id="infantry"></civ-units>
      <civ-units class="unitelem" id="artillery"></civ-units>
      <civ-units class="unitelem" id="mounted"></civ-units>
      <civ-units class="unitelem" id="aircraft"></civ-units>
    </div>
   </div>

    <civ-buildings class="buildings" id="bld"></civ-buildings>
        
    <div class="resourcesbox">
      <div class="unitname">{{localize('resources')}}</div>
      <civ-resources id="resources"> </civ-resources>
    </div>
  
  </div>
   
    <div class="wondersbox">
      <div class="unitname">{{localize('wonders')}}</div>      
      <civ-dispwonders id="wonders"></civ-dispwonders>
    </div>
      
        
  
</span>
  
  </template>

<script>
class CivMarket extends Polymer.CivData(Polymer.Element) {

    static get is() { return 'civ-market'; }
    
    _clearunits(e) {
    	const na = C.unittypes()
    	for (var i=0; i<na.length; i++) {
  	       const u =  na[i]
   	       const elem = C._getbyid(e,u)
   	       elem.draw(null) 
	     }     		
    }
    
    refresh(b) {
        const res = this.$.resources
    	if (b == null) {
    		res.draw(null)
    		this._clearunits(this.$.units)
            this._clearunits(this.$.killed)
    		return
    	}
    	const units = b.board.units
    	const killed = b.board.killedunits
    	C.setUnitsNumb(this.$.units,units)
        C.setUnitsNumb(this.$.killed,killed)
        const r = b.board.resources
        res.draw(r)
        const bld = this.$.bld
        bld.draw(b.board.buildings)
        const wo = this.$.wonders
        wo.draw(b.board.wonders)
    }
}
    
customElements.define(CivMarket.is, CivMarket);
</script>

</dom-module>