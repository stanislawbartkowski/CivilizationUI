<dom-module id="civ-listtech">

<template>

  <template id="map" is="dom-repeat" items="{{techs}}">
          <civ-tech data="{{item}}"></civ-units>
 </template>

 </template>

 <script>
     class CivListTech extends Polymer.CivData(Polymer.Element) {

     static get is() { return 'civ-listtech'; }

     static get properties() {
         return {
             techs : {
                 type: Array
             },
             level : {
               type : Number
             },
             disa : {
               type : Array,
               value : []
             },
             playerlevel : {
               type : Number,
               value : null
             },
             clickTech : {
               type : Object,
               value : null
             }
         }
     }

     _disa(c) {
       if (this.playerlevel == null) return false
       if (this.playerlevel < c.level) return true
       for (var i=0; i<this.disa.length; i++)
         if (this.disa[i] == c.name) return true
       return false
     }

     refresh(pa) {
       this.techs = []
       if (pa == null) return
       const leve = this.level
       for (var i=0; i<pa.length; i++) {
         const c = pa[i]
         c.disa = this._disa(c)
         if (this.clickTech != null) c.clickTech = (d => this.clickTech(d))
         if (pa[i].level == leve) this.techs.push(c)
       }
     }

   }

   window.customElements.define(CivListTech.is, CivListTech);
 </script>
</dom-module>
